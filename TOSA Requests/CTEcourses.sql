SELECT
STU.ID,
STU.SX AS 'Gender',
School = ( select LOC.NM from LOC where stu.SC = LOC.CD),
Teacher = (select TE from TCH where MST.SC = TCH.SC and MST.TN = TCH.TN and tch.del = 0 ),
STU.ETH AS 'Ethnicity',
[Race1] = (CASE
  WHEN STU.ETH = 'Y' THEN 'Hispanic'
	WHEN STU.ETH != 'Y' AND STU.RC1 = 100 THEN 'American Indian or Alaskan Native'
	WHEN STU.ETH != 'Y' AND STU.RC1 > 200 AND STU.RC1 < 300 THEN 'Asian'
	WHEN STU.ETH != 'Y' AND STU.RC1 > 300 AND STU.RC1 < 400 THEN 'Pacific Islander'
  WHEN STU.ETH != 'Y' AND STU.RC1 = 400 THEN 'Filipino'
	WHEN STU.ETH != 'Y' AND STU.RC1 = 600 THEN 'Black or African American'
	WHEN STU.ETH != 'Y' AND STU.RC1 = 700 THEN 'White'
	ELSE ''
END),
[Race2] = (CASE
  WHEN STU.ETH = 'Y' THEN 'Hispanic'
	WHEN STU.ETH != 'Y' AND STU.RC2 = 100 THEN 'American Indian or Alaskan Native'
	WHEN STU.ETH != 'Y' AND STU.RC2 > 200 AND STU.RC2 < 300 THEN 'Asian'
	WHEN STU.ETH != 'Y' AND STU.RC2 > 300 AND STU.RC2 < 400 THEN 'Pacific Islander'
  WHEN STU.ETH != 'Y' AND STU.RC2 = 400 THEN 'Filipino'
	WHEN STU.ETH != 'Y' AND STU.RC2 = 600 THEN 'Black or African American'
	WHEN STU.ETH != 'Y' AND STU.RC2 = 700 THEN 'White'
	ELSE ''
END),
stu.rc1,
stu.rc2,
LowSocioEcoStatus =  case when stu.id in (select fre.id from fre where fre.id = stu.id and fre.cd in ( 'f', 'r' ) and  (fre.esd > '7/1/2020' and fre.eed = '6/30/2021' ) and fre.del = 0 and ( stu.ped = 14 or fre.cd is not null )) then 'Y' else 'N' end,
SEC.SE AS 'Section Number',
CRS.CO AS 'Course Title',
CRS.CN AS 'Course ID'
FROM SEC
JOIN STU ON (STU.SC = SEC.SC) AND (STU.SN = SEC.SN)
JOIN CRS ON (CRS.CN = SEC.CN)
JOIN MST ON (MST.SC = SEC.SC) AND (MST.SE = SEC.SE)
WHERE STU.DEL = 0
AND STU.TG = ''
--AND STU.SC IN (30,31,32)
--AND CRS.VCL IN ('01','02','03')
AND SEC.SC = 20 AND SEC.CN IN (52200,522400,522410,522420)
OR SEC.SC = 15 AND SEC.CN = 'E00900'
OR SEC.SC = 31 AND SEC.CN IN (513550,515420,515850,715555)
OR SEC.SC = 21 AND SEC.CN IN (522710,522410,522400,525420)
OR SEC.SC = 10 AND SEC.CN IN (533000)
OR SEC.SC = 32 AND SEC.CN IN (512400, 513550, 515420, 813551)
ORDER BY SEC.SC, SEC.SE



--------------------------------------------


SELECT
COUNT(DISTINCT(STU.ID))
FROM SEC
JOIN STU ON (STU.SC = SEC.SC) AND (STU.SN = SEC.SN)
WHERE STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 20 AND SEC.CN IN (525420,522400,522410,522000)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 31 AND SEC.CN IN (815670,515340,615820,515750,816101,516750,812020,812600,413450,413450,812810,812140,812000,313227,415500,817501,812800,515850,513550,715555,612650)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 21 AND SEC.CN IN (525420,522400,522410,522710)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 32 AND SEC.CN IN (515851,515340,812310,515750,812030,812050,816101,816111,516750,812020,413450,513851,512310,813310,812955,415500,812351,812230,812130,513712,817501,515420,512400,813551,513550)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 30 AND SEC.CN IN (815670,413450,415500,415500)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 10 AND SEC.SE IN (344,338,351,536,539,622,625,627,342)
OR STU.DEL = 0 AND STU.TG = '' AND SEC.SC = 15 AND SEC.SE IN (106,110,204,312,400,401,402,403,404,405,406,407,408,415,506,604)
