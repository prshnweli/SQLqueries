USE Aeries

SELECT
StudentID = stu.id,
StudentFN = STU.FN,
StudentLN = STU.LN,
MAP_ELAScore_Fall18 = ISNULL ((SELECT TOP (1) SS AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 1) AND (TA IN ('1809','1810','1811')) ORDER BY TD DESC ),''),
MAP_ELAPercentile_Fall18 = ISNULL ((SELECT TOP (1) PC AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 1) AND (TA IN ('1809','1810','1811')) ORDER BY TD DESC ),''),
MAP_MathScore_Fall18 = ISNULL ((SELECT TOP (1) SS AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 20) AND (TA IN ('1809','1810','1811')) ORDER BY TD DESC ),''),
MAP_MathPercentile_Fall18 = ISNULL ((SELECT TOP (1) PC AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 20) AND (TA IN ('1809','1810','1811')) ORDER BY TD DESC ),''),
MAP_ELAScore_Spring19 = ISNULL ((SELECT TOP (1) SS AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 1) AND (TA IN ('1812','1901','1902','1903','1904')) ORDER BY TD DESC ),''),
MAP_ELAPercentile_Spring19 = ISNULL ((SELECT TOP (1) PC AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 1) AND (TA IN ('1812','1901','1902','1903','1904')) ORDER BY TD DESC ),''),
MAP_MathScore_Spring19 = ISNULL ((SELECT TOP (1) SS AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 20) AND (TA IN ('1812','1901','1902','1903','1904')) ORDER BY TD DESC ),''),
MAP_MathPercentile_Spring19 = ISNULL ((SELECT TOP (1) PC AS score FROM TST WHERE (DEL = 0) AND (PID = stu.ID) AND (ID = 'MAP') AND (PT = 20) AND (TA IN ('1812','1901','1902','1903','1904')) ORDER BY TD DESC ),'')
FROM STU
WHERE STU.DEL = 0
AND STU.TG = ''
AND STU.SC = 32
AND STU.GR = 10
ORDER BY LN, FN
